{
  "hash": "19616c1572413e9e90fbc984ecc55f34",
  "result": {
    "markdown": "# Correlations\n\n## Item Total Correlations\n\nItem total correlations, are generally used as supporting evidence for the reliability of test forms. Items may be excluded from a test form if they have a poor correlation to the total score. The item total correlation is the correlation between the item score and the total score.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(list=ls())\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.1     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\n# load in the dataset\nresponses <- read_csv('data/responses.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 3061 Columns: 45\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (23): id, gender, dob, Q1, Q2, Q3, Q4, Q5, Q6, Q7, Q8, Q9, Q10, Q11, Q12...\ndbl (22): yg, missing, Q1_score, Q2_score, Q3_score, Q4_score, Q5_score, Q6_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n#| label: sumscores\n# sum across the columns with _score_ in the name and add to a new column called total.\n# make sure to ignore missing values\n# https://dplyr.tidyverse.org/articles/rowwise.html\n# https://dplyr.tidyverse.org/reference/pick.html?q=pick#ref-usage\nresponses <- responses %>% mutate(total = rowSums(pick(ends_with(\"_score\")), na.rm = TRUE))\n```\n:::\n\n::: {#tbl-itemr .cell tbl-cap='Item Total Correlations'}\n\n```{.r .cell-code}\n# correlate each item score with the total score\n# note that this function includes the studied item score in the total score for simplicity, but normally the item score would be excluded from the total score, see https://personality-project.org/r/html/alpha.html\nitem_total_r <- responses %>% \n  select(ends_with(\"_score\")) %>% \n  mutate(total = responses$total) %>% \n  gather(key = \"item\", value = \"score\", -total) %>% \n  mutate(item = str_remove(item, \"_score\")) %>% \n  group_by(item) %>% \n  summarise(mean = mean(score, na.rm=T), correlation = cor(score, total, use = \"pairwise.complete.obs\")) %>% \n  arrange(desc(correlation))\n  \nknitr::kable(item_total_r, digits = 2)\n```\n\n::: {.cell-output-display}\n|item | mean| correlation|\n|:----|----:|-----------:|\n|Q6   | 0.39|        0.62|\n|Q8   | 0.33|        0.60|\n|Q9   | 0.59|        0.60|\n|Q12  | 0.59|        0.58|\n|Q19  | 0.26|        0.56|\n|Q7   | 0.31|        0.56|\n|Q16  | 0.30|        0.54|\n|Q3   | 0.66|        0.50|\n|Q14  | 0.72|        0.50|\n|Q10  | 0.79|        0.48|\n|Q15  | 0.18|        0.45|\n|Q11  | 0.82|        0.43|\n|Q13  | 0.67|        0.41|\n|Q17  | 0.55|        0.41|\n|Q2   | 0.93|        0.37|\n|Q5   | 0.90|        0.37|\n|Q18  | 0.63|        0.34|\n|Q4   | 0.94|        0.34|\n|Q20  | 0.55|        0.32|\n|Q1   | 0.95|        0.32|\n:::\n:::\n\n\n## Discussion\nIs there a relationship between item difficulty and item total correlation? \nCan you plot this relationship?\nCan you see any issues with excluding items based on item total correlation?\n\n## Inter-item Correlations\n\n::: {.cell}\n\n```{.r .cell-code}\n# Correlate each item score with every other item score\n# https://corrr.tidymodels.org/\nlibrary(corrr)\nx1 <- responses %>% \n  select(ends_with(\"_score\")) %>%\n  correlate() %>% \n  rearrange() %>%\n  shave()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCorrelation computed with\n• Method: 'pearson'\n• Missing treated using: 'pairwise.complete.obs'\n```\n:::\n\n```{.r .cell-code}\nfashion(x1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        term Q1_score Q4_score Q2_score Q5_score Q11_score Q18_score Q10_score\n1   Q1_score                                                                  \n2   Q4_score      .31                                                         \n3   Q2_score      .34      .27                                                \n4   Q5_score      .29      .33      .31                                       \n5  Q11_score      .18      .22      .23      .19                              \n6  Q18_score      .10      .11      .12      .11       .13                    \n7  Q10_score      .23      .23      .24      .23       .26       .18          \n8  Q20_score      .08      .09      .11      .08       .13       .16       .09\n9  Q13_score      .15      .14      .15      .13       .19       .16       .15\n10 Q14_score      .18      .14      .20      .21       .23       .12       .31\n11  Q3_score      .20      .20      .22      .20       .17       .11       .19\n12 Q17_score      .08      .12      .12      .10       .12       .06       .17\n13  Q9_score      .11      .16      .16      .18       .26       .10       .30\n14 Q12_score      .12      .14      .12      .13       .22       .11       .25\n15  Q6_score      .10      .11      .14      .17       .16       .11       .17\n16  Q8_score      .09      .11      .07      .09       .19       .08       .25\n17  Q7_score      .07      .03      .09      .09       .10       .07       .11\n18 Q15_score      .00      .01      .04      .04       .04       .09       .07\n19 Q19_score      .06      .06      .07      .06       .10       .10       .15\n20 Q16_score      .02      .03      .05      .04       .12       .09       .12\n   Q20_score Q13_score Q14_score Q3_score Q17_score Q9_score Q12_score Q6_score\n1                                                                              \n2                                                                              \n3                                                                              \n4                                                                              \n5                                                                              \n6                                                                              \n7                                                                              \n8                                                                              \n9        .15                                                                   \n10       .10       .18                                                         \n11       .11       .18       .21                                               \n12       .07       .09       .22      .13                                      \n13       .08       .19       .28      .23       .17                            \n14       .08       .18       .24      .23       .17      .38                   \n15       .09       .18       .23      .33       .14      .32       .33         \n16       .07       .19       .24      .22       .18      .43       .38      .40\n17       .09       .14       .17      .27       .15      .27       .28      .52\n18       .09       .06       .11      .13       .17      .23       .19      .30\n19       .11       .11       .17      .19       .18      .31       .31      .41\n20       .09       .07       .16      .19       .23      .30       .32      .33\n   Q8_score Q7_score Q15_score Q19_score Q16_score\n1                                                 \n2                                                 \n3                                                 \n4                                                 \n5                                                 \n6                                                 \n7                                                 \n8                                                 \n9                                                 \n10                                                \n11                                                \n12                                                \n13                                                \n14                                                \n15                                                \n16                                                \n17      .39                                       \n18      .31      .35                              \n19      .38      .40       .42                    \n20      .37      .35       .46       .46          \n```\n:::\n\n```{.r .cell-code}\nstretch(x1, na.rm = TRUE) %>% arrange(r)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 190 × 3\n   x         y               r\n   <chr>     <chr>       <dbl>\n 1 Q1_score  Q15_score 0.00206\n 2 Q4_score  Q15_score 0.0119 \n 3 Q1_score  Q16_score 0.0187 \n 4 Q4_score  Q16_score 0.0268 \n 5 Q4_score  Q7_score  0.0323 \n 6 Q5_score  Q15_score 0.0370 \n 7 Q11_score Q15_score 0.0385 \n 8 Q5_score  Q16_score 0.0435 \n 9 Q2_score  Q15_score 0.0437 \n10 Q2_score  Q16_score 0.0450 \n# ℹ 180 more rows\n```\n:::\n:::\n\n\n## Try some visulations suggested by the package eg. the network plot\n\n::: {.cell}\n\n```{.r .cell-code}\nx2 <- responses %>% \n  select(ends_with(\"_score\")) %>%\n  correlate()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCorrelation computed with\n• Method: 'pearson'\n• Missing treated using: 'pairwise.complete.obs'\n```\n:::\n\n```{.r .cell-code}\nx2 %>% network_plot(min_cor = .1)\n```\n\n::: {.cell-output-display}\n![Network diagram of inter-item correlations](ct-item-total-1_files/figure-html/network-plot-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "ct-item-total-1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}